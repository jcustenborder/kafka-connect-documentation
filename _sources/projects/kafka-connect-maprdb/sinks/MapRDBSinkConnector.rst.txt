======================
MapR DB Sink Connector
======================

The MapR DB connector is used to write data to a MapR DB cluster.


.. IMPORTANT::
    This connector requires that the MapR Client is installed and working properly on the host running the connect worker process. The Kafka Connect worker process must be started with `-Dmapr.home.dir=/opt/mapr -Djava.library.path=/opt/mapr/lib/`. You can do this by exporting the KAFKA_OPTS environment variable. For example `export KAFKA_OPTS="-Dmapr.home.dir=/opt/mapr -Djava.library.path=/opt/mapr/lib/"` before starting Kafka Connect.


.. TIP::
    The table on the MapR DB cluster is selected based on the topic name. If you need to change this take a look at the :ref:`RegexRouter <regexrouter>` transformation which can be used to change the topic name before it's sent to MapR DB.



-------------
Configuration
-------------

-------
General
-------


^^^^^^^^^^^^^^^^^^^
mapr.table.cache.ms
^^^^^^^^^^^^^^^^^^^

Number of milliseconds to cache a Table object.

**Importance:** Low

**Type:** Long

**Default Value:** 60000

**Validator:** [1000,...]






--------
Examples
--------

^^^^^^^^^^^^^^^^^^^^^^
Property based example
^^^^^^^^^^^^^^^^^^^^^^


This configuration is used typically along with `standalone mode
<http://docs.confluent.io/current/connect/concepts.html#standalone-workers>`_.

.. code-block:: properties
    :name: connector.properties
    :emphasize-lines: 4

    name=MapRDBSinkConnector1
    connector.class=io.confluent.connect.mapr.db.MapRDBSinkConnector
    tasks.max=1
    topics=< Required Configuration >




^^^^^^^^^^^^^^^^^^
Rest based example
^^^^^^^^^^^^^^^^^^


This configuration is used typically along with `distributed mode
<http://docs.confluent.io/current/connect/concepts.html#distributed-workers>`_.
Write the following json to `connector.json`, configure all of the required values, and use the command below to
post the configuration to one the distributed connect worker(s). Check here for more information about the
`Kafka Connect REST Interface. <https://docs.confluent.io/current/connect/restapi.html>`_

.. code-block:: json
    :caption: Connect Distributed REST example
    :name: connector.json
    :emphasize-lines: 6

    {
      "config" : {
        "name" : "MapRDBSinkConnector1",
        "connector.class" : "io.confluent.connect.mapr.db.MapRDBSinkConnector",
        "tasks.max" : "1",
        "topics" : "< Required Configuration >"
      }
    }



Use curl to post the configuration to one of the Kafka Connect Workers. Change `http://localhost:8083/` the the endpoint of
one of your Kafka Connect worker(s).

.. code-block:: bash
    :caption: Create a new connector

    curl -s -X POST -H 'Content-Type: application/json' --data @connector.json http://localhost:8083/connectors


.. code-block:: bash
    :caption: Update an existing connector

    curl -s -X PUT -H 'Content-Type: application/json' --data @connector.json http://localhost:8083/connectors/MapRDBSinkConnector1/config



